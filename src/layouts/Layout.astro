---
// Layout.astro
interface Props {
  title: string;
  description?: string;
  canonical?: string;
  keywords?: string;
}
const { title, description, canonical } = Astro.props;
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
---

<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>

    <meta name="description" content={description ?? "The Latin Action - Salsa y Bachata en Elche"} />
    {canonical && <link rel="canonical" href={canonical} />}

    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="https://unpkg.com/photoswipe/dist/photoswipe.css" />
  </head>
  <body class="bg-gray-900 text-white">

    <Header />

    <main class="min-h-screen">
      <slot />
    </main>

    <Footer />

    <!-- PhotoSwipe template (global) -->
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="pswp__bg"></div>
      <div class="pswp__scroll-wrap">
        <div class="pswp__container">
          <div class="pswp__item"></div>
          <div class="pswp__item"></div>
          <div class="pswp__item"></div>
        </div>
        <div class="pswp__ui pswp__ui--hidden">
          <div class="pswp__top-bar">
            <div class="pswp__counter"></div>
            <button class="pswp__button pswp__button--close" title="Cerrar (Esc)"></button>
            <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
            <div class="pswp__preloader">
              <div class="pswp__preloader__icn">
                <div class="pswp__preloader__cut">
                  <div class="pswp__preloader__donut"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="pswp__caption">
            <div class="pswp__caption__center"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Global PhotoSwipe Initialization -->
    <script type="module" is:inline>
      import PhotoSwipeLightbox from "https://cdn.jsdelivr.net/npm/photoswipe@5.3.9/dist/photoswipe-lightbox.esm.min.js";

      document.addEventListener("DOMContentLoaded", () => {
        const galleryEls = document.querySelectorAll("[data-pswp-gallery]");
        galleryEls.forEach((galleryEl) => {
          const lightbox = new PhotoSwipeLightbox({
            gallery: galleryEl,
            children: "a",
            pswpModule: () =>
              import("https://cdn.jsdelivr.net/npm/photoswipe@5.3.9/dist/photoswipe.esm.min.js"),
            zoomAnimationDuration: 0,
            arrowKeys: true,
            clickToCloseNonZoomable: true,
            mainScroll: false,
            maxSpreadZoom: 2,
          });

          lightbox.on("gettingData", (e) => {
            if (!e.element || !e.data) return;
            e.data.width = parseInt(e.element.dataset.pswpWidth || "0");
            e.data.height = parseInt(e.element.dataset.pswpHeight || "0");
          });

          lightbox.init();
        });
      });
    </script>
  </body>
</html>

<style is:global>
  html, body {
    font-family: "Inter", sans-serif;
    background: linear-gradient(to bottom, #3a304d, #281f38);
    color: white;
    max-width: 100vw;
    overflow-x: hidden;
  }
</style>
