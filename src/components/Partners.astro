---
// Get current path to determine theme colors
const currentPath = Astro.url.pathname.replace(/\/$/, "").toLowerCase();

interface RouteClasses {
  [key: string]: {
    gradient: string;
    textGradient: string;
    accent: string;
    borderColor: string;
    iconBg: string;
  };
}

const routeClasses: RouteClasses = {
  "/lady-style-elche": {
    gradient: "bg-gradient-to-r from-ladyStyle-gradient-from to-ladyStyle-gradient-to",
    textGradient: "from-ladyStyle-gradient-from to-ladyStyle-gradient-to",
    accent: "text-ladyStyle-gradient-from",
    borderColor: "border-ladyStyle-gradient-from/20",
    iconBg: "bg-ladyStyle-gradient-from/10",
  },
  "/bachata-y-salsa-en-pareja-elche": {
    gradient: "bg-gradient-to-r from-bachataSalsa-gradient-from to-bachataSalsa-gradient-to",
    textGradient: "from-bachataSalsa-gradient-from to-bachataSalsa-gradient-to",
    accent: "text-bachataSalsa-gradient-from",
    borderColor: "border-bachataSalsa-gradient-from/20",
    iconBg: "bg-bachataSalsa-gradient-from/10",
  },
  "/": {
    gradient: "bg-gradient-to-r from-main-gradient-from to-main-gradient-to",
    textGradient: "from-main-gradient-from to-main-gradient-to",
    accent: "text-main-gradient-from",
    borderColor: "border-main-gradient-from/20",
    iconBg: "bg-main-gradient-from/10",
  },
};

const currentClasses = routeClasses[currentPath] ?? routeClasses["/"];

const partners = [
  {
    image: "/dairen.webp",
    alt: "Academia de baile DAIREN Elche",
    location: {
      name: "Elche",
      url: "https://maps.app.goo.gl/16UnuAExaLCYFaWU8",
      profesorado: "Juan Carlos y Luna - The Latin Action SB company",
    },
  },
  {
    image: "/bubaloo.webp",
    alt: "Bubaloo Academia de baile Elche",
    location: {
      name: "Elche",
      url: "https://maps.app.goo.gl/16UnuAExaLCYFaWU8",
      profesorado: "Juan Carlos y Luna - The Latin Action SB company",
    },
  },
  {
    image: "/nvfit.png",
    alt: "⏳ NVFit Novelda",
    location: {
      name: "Novelda",
      url: "https://maps.app.goo.gl/mgu7ZQAdGUk6xHcDA",
      profesorado: "Juan Carlos y Luna - The Latin Action SB company",
    },
  },
  {
    image: "/virginia.webp",
    alt: "⏳ Virginia Domenech - Vivir es bailar",
    location: {
      name: "Elda",
      url: "https://maps.app.goo.gl/89nE61n4d95nZ24Y6",
      profesorado: "Juan Carlos y Luna - The Latin Action SB company",
    },
  },
];

// Títulos dinámicos según la página
const titleText: Record<string, string> = {
  "/lady-style-elche": "Nuestras sedes para Lady Style",
  "/bachata-y-salsa-en-pareja-elche": "Dónde bailamos Bachata y Salsa",
  "/": "Nuestros Socios y Sedes"
};

const currentTitle = titleText[currentPath] ?? titleText["/"];
---

<section id="partners" aria-labelledby="partners-title" class="max-w-5xl mx-auto px-6 py-14">
  <h2
    id="partners-title"
    class={`text-4xl lg:text-5xl font-bebas tracking-tight uppercase mb-10 bg-gradient-to-r ${currentClasses.textGradient} bg-clip-text text-transparent drop-shadow-sm`}
  >
    {currentTitle}
  </h2>

  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    {
      partners.map((partner, index) => (
        <div
          class={`flex flex-col items-center p-6 rounded-2xl bg-black/20 backdrop-blur-xl shadow-lg border border-white/5 hover:border-${currentClasses.borderColor} hover:shadow-xl transition-all duration-300 hover:-translate-y-1 animate-fade-in`}
          style={`--animation-delay: ${0.2 + index * 0.1}s;`}
          title={partner.alt}
        >
          <div class={`w-28 h-28 rounded-full overflow-hidden border-4 ${currentClasses.borderColor} shadow-lg mb-4 relative`}>
            <div class="absolute inset-0 bg-white flex items-center justify-center">
              <img
                src={partner.image}
                alt={`Imagen de ${partner.alt}`}
                class="object-contain w-full h-full"
                width="112"
                height="112"
                loading={index === 0 ? "eager" : "lazy"}
                decoding="async"
              />
            </div>
          </div>

          <div class="text-center w-full">
            <h3 class={`${currentClasses.accent} text-lg font-medium mb-3`}>
              {partner.alt}
            </h3>
            
            <div class="space-y-3">
              <div class="flex items-center justify-center gap-2">
                <span class={`w-8 h-8 rounded-full ${currentClasses.iconBg} flex items-center justify-center flex-shrink-0`}>
                  <svg xmlns="http://www.w3.org/2000/svg" class={`h-4 w-4 ${currentClasses.accent}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                  </svg>
                </span>
                <p class="text-sm text-gray-300">
                  {partner.location.profesorado}
                </p>
              </div>

              <div class="flex items-center justify-center gap-2">
                <span class={`w-8 h-8 rounded-full ${currentClasses.iconBg} flex items-center justify-center flex-shrink-0`}>
                  <svg xmlns="http://www.w3.org/2000/svg" class={`h-4 w-4 ${currentClasses.accent}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                  </svg>
                </span>
                <a
                  href={partner.location.url}
                  target="_blank"
                  rel="noopener noreferrer"
                  class={`text-sm text-gray-300 hover:${currentClasses.accent} hover:underline transition-colors duration-300`}
                >
                  {partner.location.name}
                </a>
              </div>
            </div>
          </div>
        </div>
      ))
    }
  </div>
  
  <div class="flex justify-center items-center mt-12 pt-4 animate-fade-in" style="--animation-delay: 0.8s;">
    <a
      href="https://wa.me/34645089122?text=Hola,%20me%20gustaría%20información%20sobre%20las%20ubicaciones%20de%20vuestras%20clases"
      target="_blank"
      rel="noopener noreferrer"
      class={`inline-flex items-center gap-2 ${currentClasses.gradient} text-white text-base font-medium py-3 px-8 rounded-full shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/30`}
    >
      <svg width="18" height="18" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
        <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z" />
      </svg>
      Consultar disponibilidad
    </a>
  </div>
</section>

<style>
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .animate-fade-in {
    animation: fadeIn 1.2s ease-out forwards;
    animation-delay: var(--animation-delay, 0s);
  }
</style>